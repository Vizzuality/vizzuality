extends ../layout.jade

block vars
  - var title = data.short_title + ': ' + data.title + ' | ' + data.client
  - var description = content.replace(/<\/?[^>]+(>|$)/g, '').slice(0, 157) + '...'

block main
  section.m-project-detail
    
    header.m-project-detail-header(style="background-image: url(/assets/images/projects/#{data.innerImage})")
      .veil
      .row
        .grid-sm-14.grid-lg-12.offset-lg-1
          //- p(style= data.color ? "color: #{data.color}" : "")
          //-   strong #{data.short_title}
          h1(style= data.color ? "color: #{data.color}" : "")= data.title
          p(class="summary")= data.summary       

    a(href="#{data.link}" class="btn btn-check") Check it online

    .m-project-detail-content
      .row

        if data.client_logo
          .grid-sm-8.grid-md-8.grid-lg-8.offset-lg-1
            | !{content}
          .grid-sm-5.grid-md-5.grid-lg-4.offset-sm-1.offset-md-1.offset-lg-1
            .client-info
              if data.client
                h2 #{data.client}.
              if data.stringDate
                p(class="date") #{data.stringDate}.
              img.m-project-client-logo(src="/assets/images/clients/#{data.client_logo}")

              if data.link
                p
                  a(href="#{data.link}" class="btn") Check it online
        else
          .grid-sm-14.grid-lg-3.offset-lg-1
            | !{content}
    
    
  if data.modules.video
    if data.video_test_style
      section.m-project-detail-video.data.no-bg
        .row
          .grid-sm-14.grid-lg-8.offset-lg-1
            //- h2= data.modules.video.title
            iframe(src=data.modules.video.url, frameborder="0", allowfullscreen)
    else
      section.m-project-detail-video  
        .row
          .grid-sm-14.grid-lg-10.offset-lg-2
            //- h2= data.modules.video.title
            iframe(src=data.modules.video.url, frameborder="0", allowfullscreen)

  if data.modules.text_left
    section.m-project-detail-article.is-left
      .row.sameheight
        .grid-sm-14.grid-lg-5.offset-lg-1.is-grid-centered
          .m-project-article-content
            h2= data.modules.text_left.title
            p !{data.modules.text_left.description}
            a(href="#{data.link}", target="_blank", class="btn-secondary") See online
        .grid-sm-14.grid-lg-8
          img(src="/assets/images/projects/#{data.modules.text_left.image}")


  if data.modules.text_left_v2
    section.m-project-detail-article.is-left
      .row
        .grid-sm-14.grid-lg-8.offset-lg-1.is-grid-centered
          .m-project-article-content
            h2= data.modules.text_left_v2.title
            p !{data.modules.text_left_v2.description}
            //- a(href="#{data.link}", target="_blank", class="btn") See online
        
        div#parallax-content.parallax-content
          div(style="background-image: url('/assets/images/projects/#{data.modules.text_left_v2.image}')")
    
  if data.modules.text_right
    section.m-project-detail-article.is-right
      .row.sameheight
        .grid-sm-14.grid-lg-8.is-grid-centered
          img(src="/assets/images/projects/#{data.modules.text_right.image}")
        .grid-sm-14.grid-lg-5.is-grid-centered
          .m-project-article-content
            h2= data.modules.text_right.title
            p !{data.modules.text_right.description}

  if data.modules.text_above
    section.m-project-detail-article
      .row.sameheight
        .grid-sm-14.grid-lg-8.offset-lg-1
          .m-project-article-content
            h2= data.modules.text_above.title
            p !{data.modules.text_above.description}
            img(src="/assets/images/projects/#{data.modules.text_above.image}")
        
  if data.modules.blocks
    section.m-project-detail-blocks
      .row.uncollapse
        .grid-sm-14.grid-lg-12.offset-lg-1
          h2= data.modules.blocks.title
      .row.uncollapse
        each m, i in data.modules.blocks.modules
          if i == 0
            .grid-sm-14.grid-md-4.grid-lg-4.offset-lg-1
              .thumb: img(src="/assets/images/projects/#{m.image}")
              p !{m.description}
          else
            .grid-sm-14.grid-md-4.grid-lg-4
              .thumb: img(src="/assets/images/projects/#{m.image}")
              p !{m.description}

  if data.modules.map
    section.m-project-detail-iframe
      .row
        .grid-sm-14.grid-lg-12.offset-lg-1
          h2= data.modules.map.title
          .m-project-iframe
            .m-project-iframe-content
              iframe(src=data.modules.map.url, frameborder="0")
          p !{data.modules.map.description}
  
  if data.opinions && data.opinions.length
    section.m-project-opinions
      .row.uncollapse.sameheight
        for opinion, index in data.opinions
          if index == 0
            .grid-sm-14.grid-lg-4.offset-lg-1
              .m-project-opinion-item: div
                if opinion.photo
                  p.m-project-opinion-photo: img(src="/assets/images/projects/#{opinion.photo}")
                p.m-project-opinion-text !{opinion.title}
                p.m-project-opinion-autor !{opinion.autor}
          else
            .grid-sm-14.grid-lg-4
              .m-project-opinion-item: div
                if opinion.photo
                  p.m-project-opinion-photo: img(src="/assets/images/projects/#{opinion.photo}")
                p.m-project-opinion-text !{opinion.title}
                p.m-project-opinion-autor !{opinion.autor}

  if data.link || data.post_url
    footer.m-project-detail-footer
      .row.sameheight
        if data.link && data.post_url
          .grid-sm-14.grid-lg-7.is-grid-centered.m-project-url
            div: a(href="#{data.link}", target="_blank", class="btn-secondary") Check it online
        else if data.link
          .grid-sm-14.grid-lg-14.is-grid-centered.m-project-url
            div: a(href="#{data.link}", target="_blank", class="btn-secondary") Check it online

        if data.link && data.post_url
          .grid-sm-14.grid-lg-7.is-grid-centered.m-project-post
            div
              if data.post_title
                h2= data.post_title
              a(href="#{data.post_url}", class="btn-secondary") Read blog post
        else if data.post_url
          .grid-sm-14.grid-lg-14.is-grid-centered.m-project-post
            div
              if data.post_title
                h2= data.post_title
              a(href="#{data.post_url}", class="btn-secondary") Read blog post

  section.m-message
    .row
      .grid-sm-14.grid-lg-12.offset-lg-1
        p Get in touch.
        a(href="/about#contact", class="btn") Contact us

  //- if (prev)
  //-   section.m-project-detail-next(style="background-image: url(/assets/images/projects/#{prev.image})")

  if (next)
    section.m-project-detail-next(style="background-image: url(/assets/images/projects/#{next.image})")
      .veil
      .row
        .grid-sm-14.grid-lg-12.offset-lg-1
            p= next.client
            h1: a(href="/projects/#{next.slug}")= next.title
